function e(e){return e&&e.__esModule?e.default:e}var r=globalThis,t={},a={},n=r.parcelRequire6f20;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var r=a[e];delete a[e];var n={id:e,exports:{}};return t[e]=n,r.call(n.exports,n,n.exports),n.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,r){a[e]=r},r.parcelRequire6f20=n),(0,n.register)("dRo73",function(e,r){Object.defineProperty(e.exports,"register",{get:()=>t,set:e=>t=e,enumerable:!0,configurable:!0});var t,a=new Map;t=function(e,r){for(var t=0;t<r.length-1;t+=2)a.set(r[t],{baseUrl:e,path:r[t+1]})}}),n("dRo73").register(new URL("",import.meta.url).toString(),JSON.parse('["jVlne","index.cfd80ee1.js","2vMQB","../../1.1c79e02e.png","jgh6g","../../2.77821e30.png","670nB","../../3.12cc791a.png","fx6Vo","../../4.70762dd7.png","knvah","../../5.83ae63bf.png"]'));var o={};o=new URL("../../1.1c79e02e.png",import.meta.url).toString();var l={};l=new URL("../../2.77821e30.png",import.meta.url).toString();var i={};i=new URL("../../3.12cc791a.png",import.meta.url).toString();var c={};c=new URL("../../4.70762dd7.png",import.meta.url).toString();var s={};s=new URL("../../5.83ae63bf.png",import.meta.url).toString();const d=125,f=4*d+100,u=4*d+100,h="#C2B4A5",p=6,m=[/*@__PURE__*/e(o),/*@__PURE__*/e(l),/*@__PURE__*/e(i),/*@__PURE__*/e(c),/*@__PURE__*/e(s)],// VALUES = [
//   'https://bideyuanli.com/wp-content/themes/2048/zhan/1.png',
//   'https://bideyuanli.com/wp-content/themes/2048/zhan/3.png',
//   'https://bideyuanli.com/wp-content/themes/2048/zhan/4.png',
//   'https://bideyuanli.com/wp-content/themes/2048/zhan/5.png',
//   'https://bideyuanli.com/wp-content/themes/2048/zhan/6.png'
// ],
g=["#EEE4DA","#EDE0C8","#EDA166","#F08151","#F1654D","#F1462E","#E8C65F","#E8C34F","#E8BE40","#E8BB31","#E8B724"],v=64,E=128,A=.3;// 最大缩放比例
/** @type {HTMLCanvasElement} */let x=document.createElement("canvas"),w=x.getContext("2d");x.width=f,x.height=u,x.style.cssText="position: absolute; inset: 0; margin: auto;",document.body.appendChild(x),document.body.style.backgroundColor="#F9F7EB";let y=Array.from({length:4},()=>[,,,,].fill(-1)),F=0,R=[],_=[],S=[],H=[],b=[],D=Array(m.length).fill(!1);Array(m.length).fill(!0),document.addEventListener("keydown",e=>{let r=q[e.key];r&&U(r,y,e.key)});const U=async(e,r,t)=>{_=[],R=[],H=[],S=[];let a=e(JSON.parse(JSON.stringify(r)),t);if(a.toString()===r.toString())return;y=a;let n=await B(_,R,t);if(cancelAnimationFrame(n),H.length>0){let e=M[t];H=H.map(({index:r,end:t,val:a})=>e(r,t,a)),S=S.map(({index:r,end:t,val:a})=>e(r,t,a));let r=await C(H,S);cancelAnimationFrame(r)}P()},L={ArrowUp:(e,r,t,a)=>({x:e,y:3-r-a,val:t}),ArrowDown:(e,r,t,a)=>({x:e,y:r+a,val:t}),ArrowLeft:(e,r,t,a)=>({x:3-r-a,y:e,val:t}),ArrowRight:(e,r,t,a)=>({x:r+a,y:e,val:t})},M={ArrowUp:(e,r,t)=>({x:e,y:3-r,val:t}),ArrowDown:(e,r,t)=>({x:e,y:r,val:t}),ArrowLeft:(e,r,t)=>({x:3-r,y:e,val:t}),ArrowRight:(e,r,t)=>({x:r,y:e,val:t})},B=(e,r,t,a=v)=>new Promise(n=>{let o=null,l=null,i=[],c=null,s=L[t],d=M[t];r=r.map(({index:e,end:r,val:t})=>d(e,r,t));let h=t=>{o||(o=t),w.clearRect(0,0,f,u),Q(),J(y),r.forEach(({x:e,y:r,val:t})=>I(e,r,t)),i.forEach(({x:e,y:r,val:t})=>I(e,r,t)),(l=t-o)<a?(i=e.map(({index:e,start:r,val:t,distance:n})=>s(e,r,t,n*l/a)),// activeGroup = moveGroup.map(({index, start, val, distance}) => getMovePos(index, start, val, distance * Math.sin(elapsed / duration * Math.PI / 2)));
    requestAnimationFrame(h)):n(c)};c=requestAnimationFrame(h)}),C=(e,r,t=E,a=A)=>new Promise(n=>{let o=null,l=null,i=null,c=0,s=h=>{o||(o=h),w.clearRect(0,0,f,u),Q(),J(y),r.forEach(({x:e,y:r,val:t})=>I(e,r,t)),e.forEach(({x:e,y:r,val:t})=>I(e-c/2,r-c/2,t,d+d*c)),(l=h-o)<t?(// scaleRatio = (1 - Math.abs(1 - elapsed / duration * 2)) * 0.2
    c=Math.sin(l/t*Math.PI)*a,requestAnimationFrame(s)):n(i)};i=requestAnimationFrame(s)}),T=(e,r)=>{let t=[],a=!1,n=e.length;for(let o=n-1;o>=0;o--)-1!==e[o]&&(a&&e[o]===t[0]?(F=Math.max(++t[0],F),a=!1,H.push({index:r,val:e[o],end:n-t.length}),S.pop()):(t.unshift(e[o]),S.push({index:r,val:e[o],end:n-t.length}),a=!0),0==n-t.length-o?R.push({index:r,val:e[o],end:o}):_.push({index:r,val:e[o],start:o,distance:n-t.length-o}));return Array(n-t.length).fill(-1).concat(t)},O=e=>e[0].map((r,t)=>e.map(e=>e[t])),q={ArrowUp:e=>e.map((e,r)=>T(e.reverse(),r).reverse()),ArrowDown:e=>e.map((e,r)=>T(e,r)),ArrowLeft:e=>O(O(e).map((e,r)=>T(e.reverse(),r).reverse())),ArrowRight:e=>O(O(e).map((e,r)=>T(e,r)))},P=async()=>{if(k())console.log("你赢了");else{let e=[];y.forEach((r,t)=>r.forEach((r,a)=>-1!==r&&e.push({x:t,y:a,val:r})));let{x:r,y:t}=G(y),a=.5>Math.random()?0:1;y[r][t]=a,N()&&console.log(`\u{4F60}\u{8F93}\u{4E86}\u{FF01}\u{6700}\u{9AD8}\u{5206}\u{FF1A}${m[F]}`),await C([{x:r,y:t,val:a}],e)}w.clearRect(0,0,f,u),Q(),V(y)},k=()=>F===m.length-1,N=()=>!y.some((e,r)=>e.some((t,a)=>-1===t||t===e[a+1]||t===y[r+1]?.[a])),j=async()=>{m.forEach((e,r)=>{// if (isLoad[index]) return
let t=new Image;t.src=e,b[r]=t,t.onload=()=>{D[r]=!0,y.forEach((e,t)=>e.forEach((e,a)=>e===r&I(t,a,e)))}});let e=[];for(let r=0;r<2;r++){let{x:r,y:t}=G(y),a=.5>Math.random()?0:1;y[r][t]=a,e.push({x:r,y:t,val:a})}await C(e,[]),Q(),V(y)},I=(e,r,t,a=d)=>{z(e=e*(20+d)+20,r=r*(20+d)+20,a,a,void 0,g[t]),D[t]&&(w.save(),w.clip(),w.drawImage(b[t],e,r,a,a),w.restore())},J=e=>e.forEach((e,r)=>e.forEach((e,t)=>$(r,t))),V=e=>e.forEach((e,r)=>e.forEach((e,t)=>{$(r,t),-1!==e&&I(r,t,e)})),Q=()=>z(0,0,f,u,6,"#AD9D8F"),$=(e,r,t=h,a=d)=>z(e*(20+d)+20,r*(20+d)+20,a,a,6,t),z=(e,r,t,a,n=p,o)=>{w.beginPath(),w.moveTo(e+n,r),w.arcTo(e+t,r,e+t,r+a,n),w.arcTo(e+t,r+a,e,r+a,n),w.arcTo(e,r+a,e,r,n),w.arcTo(e,r,e+t,r,n),w.closePath(),o&&(w.fillStyle=o,w.fill())},G=e=>{let r=[];return e.forEach((t,a)=>t.forEach((t,n)=>-1===e[a][n]&&r.push({x:a,y:n}))),r[Math.floor(Math.random()*r.length)]};window.onload=j;