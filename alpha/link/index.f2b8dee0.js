const e=100,t=e/12,l=e/2,o=6*(e+10)+10+2*l,r=6*(e+10)+10+2*l,n=["A","B","C","D","E","F","G"],y=["#409EFF","#67C23A","#E6A23C","#F56C6C","#B37FEB","#FF85C0","#36CFC9"],f="#00AEEC",i="#F8BBD0";let s=document.createElement("canvas"),c=s.getContext("2d");s.style.cssText="position: absolute; inset: 0; margin: auto; cursor: pointer;",s.width=o,s.height=r,document.body.appendChild(s),document.body.style.backgroundColor=i;let x=Array.from({length:8},()=>Array(8).fill(-1)),a={x:-1,y:-1},d=0;s.onclick=t=>{let[o,r]=[t.offsetX,t.offsetY].map(t=>Math.ceil((t-l)/(e+10)));if(t.offsetX-(o-1)*(e+10)-l<10||t.offsetY-(r-1)*(e+10)-l<10||-1===x[o][r])return;m(o,r);let n=a.x,y=a.y;if(-1===n&&-1===y)a={x:o,y:r};else{if(n===o&&y===r){a={x:-1,y:-1},p(o,r);return}C(a,{x:o,y:r})?(x[n][y]=-1,x[o][r]=-1,a={x:-1,y:-1},d++,k(),F()&&alert("游戏结束，你赢了")):(p(n,y),a={x:o,y:r})}};const F=()=>2*d==36,h=(e,t)=>{let{x:l,y:o}=e,{x:r,y:n}=t;return l===r?(o>n&&([o,n]=[n,o]),x[l].slice(o+1,n).every(e=>-1===e)):o===n&&(l>r&&([l,r]=[r,l]),x.slice(l+1,r).every(e=>-1===e[o]))},u=(e,t)=>{let{x:l,y:o}=e,{x:r,y:n}=t;for(let[e,y]of[[1,0],[-1,0],[0,1],[0,-1]]){let f=0,i=l,s=o,c={},a={};for(;x[i=l+e*++f]?.[s=o+y*f]===-1;)if(c={x:i,y:s},(a=0===e?{x:r,y:s}:{x:i,y:n}).x===r&&a.y===n&&h(c,t)||-1===x[a.x][a.y]&&h(c,a)&&h(a,t))return!0}return!1},C=(e,t)=>x[e.x][e.y]===x[t.x][t.y]&&(!!h(e,t)||u(e,t)),m=(l,o,r=f)=>{c.strokeStyle=r,c.lineWidth=t,c.strokeRect(g(l)+t/2,g(o)+t/2,e-t,e-t)},p=(e,t)=>{b(e,t,x[e][t])},E=()=>{c.fillStyle=i,c.fillRect(l,l,o-2*l,r-2*l)},g=t=>(t-1)*(e+10)+10+l,A=e=>e.sort(()=>Math.random()-.5),B=()=>{let e=[],t=0;for(let l=0;l<18;l++)t=l%n.length,e.push(t,t);let l=A(e);for(let e=1;e<7;e++)for(let t=1;t<7;t++)x[e][t]=l.pop()},b=(t,l,o,r=e)=>{t=g(t),l=g(l),c.fillStyle=y[o%y.length],c.fillRect(t,l,r,r),c.font="40px serif",c.fillStyle="#FFFFFF",c.textBaseline="middle",c.textAlign="center",c.fillText(n[o],t+r/2,l+r/2)},k=()=>{c.clearRect(0,0,o,r),E(),x.forEach((e,t)=>e.forEach((e,l)=>-1!==e&&b(t,l,e)))},R=async()=>{B(),k()};window.onload=R;